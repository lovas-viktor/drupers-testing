language: php
php: 5.6
source_key: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlKS0FJQkFBS0NBZ0VBekxVQWtWVElqUW5DOGs5U2o3YUNhb3J3OVhzdUhCZGk5OGpQbEFtZ0dVN1J0YUV5CkVaVU11YU1COGNTVEtqZ2VRZ2dadWF3Q0RlUks1bUs3ZGxQR1UvWkF5SEN0d0xvZi9HSlpqWDlSUXdsaXVBWnUKL3VBQ2d6WkZndHU0YVRZajBEWjJCay9GdDd0RFQzRDNsdjZ4Z2VKa3FpK1VxVzBPWDhZNzBTS2pudDk5R2xjZgpDVFUvTks4MXdVUTVTYTVYZlI2cWk2anNvU2NNZC92TUtUSnVRb1F3MEx0N29iQ2tHL0dUZy9FRHlNZUFTY2dYCjVQZERKQklRcVA0dGhicXBTczBSM3BQWVU3ZUp2MEtlLzV6MURWSTFxcExaYjIyR25QN3lJOW1Cc29Ud2ExL3kKbWVFSitQZnhldTZxZlU0ZngydnIrckdINCtYYndhOWRaU2F4VVpQRDMzd0RSMzVQV0M4QXU3S01uUWF3djlLcApSTE4vNlpJbjNWUjI3RU5YSXMxSUY3eGZvWEN2aVBTYTlXYVNTOTlxWkdHZmlrNm04NUZuRVZLc0hvTU5IWHNoCng5NHBwSTR3Z1NqU0lhallrZnNPc2JuaG1jSlN2a3lmbUxrQWl2WUFPZmtMYjRHdGFCUWFmZ1pIRm1RbGZwRjYKTFpuRnI5Vm1PZDVac2k5YXdPN3A5Z2hscnE2QTRXQS9Ed2ZvWDdLMlBXNndRV1d0eGN1U2VkL1BZS295cThOWQpIMk5EWURzM2huRUhkYk8rTndIdlZtRmRRQlBBbHVoaVkrc29MVTFzY3VXWHIrV0tFM3BiZzJ0ZUllZE5scEpVCmh2bi9GQ3ZIcnNQeXg5aGJ6UUorcnhlWUZ2SUhuRlVUODhseHc1aUJVa0JYeWxuR2xrZzFRdCtFZk1jQ0F3RUEKQVFLQ0FnQXhudFpxWkJEUkQwS3dGY1kvaTlBRkgzVFZMR3k2NW5oWTg5Wk5YaC91d29wVzZxSUdYUWplbnNMRAo1aEIrTldnd1BXSnUvV0RxR1NLR3dmd0s3TGV3ZG9xeGk0NnludXROOUZFYzJYWExPQ1V6MG10cFlNZDdJdGFxCnA3UUYzTmZGaXM0RkxhVVJxbFRnbHRPTlNHT2l4a3Y4Yk5ndVVYOGdmQjdYelB1NGNSZ1VJSFluZHo3QStJK2gKTDNacmc5VTFRUSs2RnRKMUpkQUI3WWxKbXkzYTljd1hiTHJGTU5vMjQ5SU1NNG5sUzJhdmU4OCs4eWpWUDRQRwpVd2FaMmV0YmRHWVdlK1ArTndrdTBXbFZNS2k5OStXR1dWNVhna2NWR3o5NnJTaWhLMVJUMHNndHdMejRHckh3ClNKWVBGYmJpVWlpN2Rma29wdmtqOCt4QnJxVmdYejNVNUViazd4aW0vUkg2S0wvOUVEOVNPcHNMNkVQaHJ5SnMKYXh1YTh5NWhBeS9RRG1ScFVEVFpTUkxOQk9vN0RoNE9ZU1BZZUVvNVZaQ3owVnVEMkttUEFXd1lIdHhnK0ZsZwpTWjVaa1lBS256T1dCL2RRU2J1TlpuQ0hTRlBxM3B5djN6V3pjSjZpOEcwc1cyVWppNy8zY0djUks2NXB4dlVtCnBsa051VWxTS3N4dkhVU1BwSFFseTVGLzBjNFQram1yVkNZbkkycFBGeWFuNjFUclJEV1F0QnlPZ2JqK2J6NEwKNXdtZjhSUHBTN2hVUkg2Si85OE9LMjg1dGkzSTcwdTNyN3lZbnVQbDJSRmV1dUhKRUtyUnBIL3owa0xMVnQ2RwpBbEJNS2ZDbGg4Nms1VEpDQ042bEZLQTBkUktrOWJrV0RBY21nRk5mbU1NYjc2dkljUUtDQVFFQS93c2FneXErCklVTkhpTjRVazg3Z29Ob1RYZmtXZDdJaTlKS052TEpMeVhWTXpQSlJZS3huQnR2bGt2enpWaFdBV0RVVXZvQ1oKNlgyMGdHb1RXR2JPU2xyaitLVkl6WkFWNEg4UDdnRm5leHV2Yk9LMzBTNUpEbVk5eTdiMmRRUGl5MkZaMkh0bQpkTUJXTnBzbnNnalpDREhmZm9XKzlrT2lvQkQ3R0c5NG9PM2p4MExkZHRnNFBJUnh6MVZWKzRTUkNHUEExZUtJCjh3ZkIrSUtWTzZzYlZOTU14djFRbUs3TEZpTVdxc0xpK2FzQk8rdkpRRlJJa3g0MzNNdGVwNmRpU0hqKzVXalQKNkJGL1hoWlJJaU9JYkFsK0RyVlZuUCtGUkpCaVI3QnRvazFGWWNXdEVpajlRWVNiRHRQcEN5R3ZaQmJ0Y3dMeQpMY2lIUFVDRmJlUVVpd0tDQVFFQXpYbVFvUjdIRlZmRlpiRllpRkswVGVzQXZNd3VEU09CNnZjQmtvdm0ybHMxCnFuWkdSanBHYk5KSzhjZHI4WDZoOGtIWEpMNnM1M1JRc3duTUZjNDgyVDNaU2RkVHF4bkZBWVJQZ0dPTDNmbk0KQ2Y2a043U3ljRDZDRlRzTXJJMkNnNFJmKzl3bXVwUCtncVBudlhMalExWUlFbjdWUnkxRG4wSEFxcWRJWUdKdQpKM01jYUtCTlpveEZ6UkNhQmNDUlU5TFZFZmFSSW5oV1g0NGVqdHRMRlp3aU1xUXZTRWkySk9reXZ3NVkzUU9yCldtZTRvRE0rZjJ5OWtTQ0dwSjU5cHBxMWlFakVKZ0h0NnpxNW5UNUdTaDRmenh3MDF6UUFsU0VjVWlGUEwwN0YKb1YxTm9uQXRJMVhCWC9MZDVESjFtTWNuZy8xZFdtZTFjVFdUSldBME5RS0NBUUJGMUt4MXJZWlJaVEo0N3hXRApRdW1PSVNlY1cwOGpoc3E3WEVVaW5VN1M0aU1kR2x2ZHRGYWhNaVF4a3NDdG1VV0M0VVhFdzBGaEJPSWZKdXdWCkVGRDdXdGVBaFFEaUI4bDFwbFNlUGhRdlNPMUhTdXc1Z2dyT3ZuKzgvMk9MdG55cVl3Vk9tTHI4ekl6T2RyenYKcWl5Q2FlVmZwdzhhTG5xZ2lRVzNNdzQ4UWVaVDhLTGluMkVHY04wWWY2MERLTkR0RXlNQmJQMUNUYVYyZllxTwp3OUsvN3VsWXNwTVd1d1V3RW50cVZlSC9xaXEwVldMTkVrYXN3V0ZhT3ZTM3dzVE9ReExIaldRMzdsS0pXR0x1Cmpmd1VXS1VETWZNM0FWOWozb1NLVEd3NFBCLzdIVHk5OUNzamZVTlhVLzVDNWY0MzBXOUNSbFE0NU9iaWhvQUMKRHFqeEFvSUJBRmRHcEgwYmNwcUpMb3AwV3RPRXRadEhENGdoL2dtTXBIbG1NNS9JbHVUMnl3Tzl1em5ITlBTeQpHaTA2ZElvZUxMR1c3OGhteVZDQ29taDU1OXIzUC9kU2d3SVBXVFdhKzRnYWFCNXpxZ3crTjBHampLTXd1SDVlCnZxZy83YkU1Wms5d29jaDhDV05FeTEwNE80M0h4K3BwRjRLcnB2SFZzeHhwTkdvSUpnRHlyakZKZnE2ZU1HSTMKZ01xS203R0h5dkxjNGE0QW1rTVc5REVnVDdDRVN3OUJ3M0RaTmxBd3VsVlJURUhFMlUvL2FBQTlnRGxqcXM4NwpKQVlKMThjQ253SnVRbDlCOFRibnFPUTZqRzdTN2M0N24yMDhZT0ZyOERkbjJmeTBzMHEzM2RBZHJvVXB1cktBCmtXT3M2RDB1aGE3QUlQTzZZYld0eVc3dHY3T25lbVVDZ2dFQkFQenpnSVZEbjdRY3JyWEVaelFqUnJ4VDgvN1AKMW1zNDFpNUUxblJhOWgwaU43WnY4S1ZWWWwzcTRNaGxyTER1T2lZSzBidmRlZmtZSzRTTHdxR0tpNG1MeHFVZAp5WUsrbUwwSDE1Q1ZEY05NYkN6YnBDTjEwZm9xTkF2NXdlODJQeGtOQ3kva3J1emVpaUIxeXJvTFpwaHJqSWliCnYwQnJScDJHa256enB5ZFF4d29OV2MzL0doYnVmR24wTHdTMzdBRjVBNWlCbUh0TjgzTVpYMG5ISmF4VmVEUnoKeitJOHNLUDVVTkFkQ1B3Tmp2YWsxTG43Q1NicmdoYUJHenBvbXVEWDBJS3JoZEUxZnBPeG1hMkU0anJnZDkvQwp3NkhGeENwYVpsbkZ5Lzk3NEJmZmtaNG5yTmJUS2RQM1JaM0ZYdVNaY1M5d2MxekgwaERVekxhZU5Zdz0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K"
env:
  global:
    - PUUID='0759f9d3-f975-4154-a0ec-7a94bd6e73b7'
    - PNAME='drupers-testing'
    - PSOURCE='dev'
    - PEMAIL='viktor.lovas@gmail.com'
    - PPASS='pantheontest'
    - PSITE=$(cat /dev/urandom | tr -cd 'a-z0-9' | head -c 4)
    - PSITE="ci$TRAVIS_BUILD_NUMBER-$PSITE"
    - PHOST="https://$TRAVIS_BRANCH-$PNAME.pantheonsite.io"
install:
  - echo "StrictHostKeyChecking no" > ~/.ssh/config
  - composer global require drush/drush:7.0.0
  - export PATH="$HOME/.composer/vendor/bin:$PATH"
  - git clone https://github.com/pantheon-systems/terminus.git $HOME/.drush/terminus
  - cd $HOME/.drush/terminus
  - composer update --no-dev
  - drush cc drush
  # Install additional test dependencies here (like Casper, Behat, etc).
before_script:
  - drush pauth $PEMAIL --password=$PPASS
  - cd $TRAVIS_BUILD_DIR
  - git checkout -b $PSITE
  - git remote add pantheon ssh://codeserver.dev.$PUUID@codeserver.dev.$PUUID.drush.in:2222/~/repository.git
  - git push --force pantheon $PSITE
  - drush psite-ecreate $PUUID $PSITE --source=$PSOURCE || true
  - drush paliases
  - drush cc drush
  - cd $HOME
  - drush @pantheon.$PNAME.$PSITE updb -y --strict=0
  - drush @pantheon.$PNAME.$PSITE en simpletest -y --strict=0
  - drush @pantheon.$PNAME.$PSITE vset -y simpletest_verbose 0 --strict=0
script:
  # Run real / additional tests here.
  #- drush @pantheon.$PNAME.$PSITE test-run MyTestClass --strict=0
after_script:
  #- drush psite-edelete $PUUID $PSITE -y
  - cd $TRAVIS_BUILD_DIR
  - git push pantheon :$PSITE